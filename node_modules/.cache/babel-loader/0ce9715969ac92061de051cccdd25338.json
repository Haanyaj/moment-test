{"ast":null,"code":"import { api_link, api_key } from '../../globals';\nexport async function request_token() {\n  const url = api_link + 'authentication/token/new';\n  let data = {\n    token: api\n  };\n  const response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n}\nexport async function signup(state) {\n  const url = api_link + '/auth/signup';\n  let data = {\n    firstname: state.firstname,\n    lastname: state.lastname,\n    email: state.email,\n    password: state.password\n  };\n  const response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  return response.status;\n}\nexport async function update_user() {\n  let token = localStorage.getItem('token');\n  const response = await fetch(api_link + \"/users/me\", {\n    method: 'GET',\n    headers: {\n      'accept': 'application/json',\n      'Authorization': 'Bearer ' + token\n    }\n  });\n  const responseToJson = await response.json();\n  let user = responseToJson;\n\n  if (user) {\n    localStorage.setItem('user', JSON.stringify(user));\n  } else {\n    console.log(\"an error occured\");\n  }\n\n  console.log(\"user changed\");\n  return response;\n}\n\nasync function change(to_change, field, uri) {\n  let url = api_link + uri;\n  let data = '{\"' + field + '\":\"' + to_change + '\"}';\n  const response = await fetch(url, {\n    method: 'PATCH',\n    body: data,\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  console.log(data);\n  await update_user();\n  return response;\n}\n\nexport async function change_password(old_password, new_password) {\n  let url = api_link + \"/users/me/password\";\n  let data = {\n    newPassword: new_password,\n    oldPassword: old_password\n  };\n  let response = await fetch(url, {\n    method: 'PATCH',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function change_username(firstname, lastname) {\n  let url = api_link + \"/users/me\";\n  let data = {\n    firstname: firstname,\n    lastname: lastname\n  };\n  let response = await fetch(url, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function change_measures(id, name, height, weight) {\n  let url = api_link + \"/users/me/measures/\" + id;\n  let data = {\n    name: name,\n    height: height,\n    weight: weight\n  };\n  let response = await fetch(url, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function create_measures(name, height, weight) {\n  let url = api_link + \"/users/me/measures\";\n  let data = {\n    name: name,\n    height: height,\n    weight: weight\n  };\n  let response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function delete_measures(id) {\n  let url = api_link + \"/users/me/measures/\" + id;\n  const response = await fetch(url, {\n    method: 'DELETE',\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function request_password_reset(email) {\n  let data = {\n    email: email\n  };\n  let url = api_link + \"/users/request-password-reset\";\n  const response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  return response;\n}\nexport async function confirm_account(token) {\n  let data = {\n    token: token\n  };\n  let url = api_link + \"/users/confirm-account\";\n  const response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function reset_password(token, pass) {\n  let data = {\n    token: token,\n    password: pass\n  };\n  let url = api_link + \"/users/password-reset\";\n  const response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  return response;\n}\nexport async function get_merchants() {\n  let url = api_link + \"/merchants\";\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  return response.json();\n}\nexport async function get_merchant(id) {\n  let url = api_link + \"/merchants/\" + id;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  return response.json();\n}\nexport async function authorize_merchant(id) {\n  let url = api_link + \"/users/me/merchants/\" + id + \"/authorize\";\n  console.log(url);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Accept': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function revoke_merchant(id) {\n  let url = api_link + \"/users/me/merchants/\" + id + \"/revoke\";\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Accept': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function delete_account() {\n  let url = api_link + \"/users/me\";\n  const response = await fetch(url, {\n    method: 'DELETE',\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport const get_user = () => JSON.parse(localStorage.getItem('user'));\nexport const get_user_merchants = () => get_user().merchants;\nexport const get_measure = (index = 0) => get_nb_measures() ? get_user().measures[index] : [];\nexport const get_measures = () => get_user().measures;\nexport const get_nb_measures = () => get_user().measures.length;\nexport const get_token = () => localStorage.getItem('token');\nexport const change_firstname = firstname => change(firstname, \"firstname\", \"/users/me/firstname\");\nexport const change_lastname = lastname => change(lastname, \"lastname\", \"/users/me/lastname\");\nexport const change_measure_name = async (id, name) => await change(name, \"name\", \"/users/me/measures/\" + id + \"/name\");\nexport const change_measure_height = async (id, height) => await change(height, \"height\", \"/users/me/measures/\" + id + \"/height\");\nexport const change_measure_weight = async (id, weight) => await change(weight, \"weight\", \"/users/me/measures/\" + id + \"/weight\");\nexport const logout = () => {\n  localStorage.clear(); //popupDisplay('center', 1500, 'success', 'Déconnexion réussie');\n  //setTimeout(function() {history.push(\"/\")},1500);\n};","map":{"version":3,"sources":["/home/haan/moment-test/src/components/tools/ApiCalls.js"],"names":["api_link","api_key","request_token","url","data","token","api","response","fetch","method","body","JSON","stringify","headers","signup","state","firstname","lastname","email","password","status","update_user","localStorage","getItem","responseToJson","json","user","setItem","console","log","change","to_change","field","uri","get_token","change_password","old_password","new_password","newPassword","oldPassword","change_username","change_measures","id","name","height","weight","create_measures","delete_measures","request_password_reset","confirm_account","reset_password","pass","get_merchants","get_merchant","authorize_merchant","revoke_merchant","delete_account","get_user","parse","get_user_merchants","merchants","get_measure","index","get_nb_measures","measures","get_measures","length","change_firstname","change_lastname","change_measure_name","change_measure_height","change_measure_weight","logout","clear"],"mappings":"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","sourcesContent":["import { api_link, api_key } from '../../globals';\n\n\nexport async function request_token() {\n    const url = api_link + 'authentication/token/new';\n    let data = {\n       token : api\n    }\n    const response = await fetch(url, {\n        method: 'POST',\n        body: JSON.stringify(data),\n        headers: {\n            'Accept': 'application/json',\n            'Content-type': 'application/json'\n        }\n    });\n}\n\nexport async function signup(state) {\n\n\tconst url= api_link + '/auth/signup';\n\tlet data = {\n\t\tfirstname: state.firstname,\n\t\tlastname: state.lastname,\n\t\temail: state.email,\n\t\tpassword: state.password,\n\t}\n        const response = await fetch(url, {\n\t\tmethod:'POST',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json'\n\t\t}\n\t})\n\treturn response.status;\n}\n\nexport async function update_user() {\n\tlet token = localStorage.getItem('token');\n\n\n\tconst response = await fetch(api_link + \"/users/me\", {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'accept': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + token\n\t\t}\n\t});\n\n\tconst responseToJson = await response.json();\n\tlet user = responseToJson;\n\tif (user) {\n\t\tlocalStorage.setItem('user', JSON.stringify(user));\n\t} else {\n\t\tconsole.log(\"an error occured\");\n\t}\n\tconsole.log(\"user changed\")\n\treturn response;\n}\n\n\nasync function change(to_change, field, uri) {\n\tlet url = api_link + uri;\n\tlet data = '{\"' + field + '\":\"' + to_change + '\"}'\n\tconst response = await fetch(url, {\n\t\tmethod: 'PATCH',\n\t\tbody: data,\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tconsole.log(data);\n\tawait update_user();\n\treturn response;\n}\n\nexport async function change_password(old_password, new_password) {\n\tlet url = api_link + \"/users/me/password\";\n\tlet data = {\n\t\tnewPassword: new_password,\n\t\toldPassword: old_password\n\t}\n\tlet response = await fetch(url, {\n\t\tmethod: 'PATCH',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response\n}\n\nexport async function change_username(firstname, lastname) {\n\tlet url = api_link + \"/users/me\";\n\tlet data = {\n\t\tfirstname: firstname,\n\t\tlastname: lastname\n\t}\n\tlet response = await fetch(url, {\n\t\tmethod: 'PUT',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\t\n\tawait update_user();\n\treturn response\n}\n\nexport async function change_measures(id, name, height, weight) {\n\tlet url = api_link + \"/users/me/measures/\" + id;\n\tlet data = {\n\t\tname: name,\n\t\theight: height,\n\t\tweight: weight,\n\t}\n\tlet response = await fetch(url, {\n\t\tmethod: 'PUT',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response\n}\n\n\n\nexport async function create_measures(name, height, weight) {\n\tlet url = api_link + \"/users/me/measures\";\n\tlet data = {\n\t\tname: name,\n\t\theight: height,\n\t\tweight: weight\n\t}\n\tlet response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response\n}\n\nexport async function delete_measures(id) {\n\tlet url = api_link + \"/users/me/measures/\" + id;\n\tconst response = await fetch(url, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response;\n}\n\nexport async function request_password_reset(email) {\n\tlet data = {\n\t\temail: email\n\t}\n\tlet url =  api_link + \"/users/request-password-reset\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t}\n\t})\n\treturn response;\n}\n\nexport async function confirm_account(token) {\n\tlet data = {\n\t\ttoken: token\n\t}\n\tlet url = api_link + \"/users/confirm-account\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t}\n\t})\n\tawait update_user();\n\treturn response;\n}\n\nexport async function reset_password(token, pass) {\n\tlet data = {\n\t\ttoken: token,\n\t\tpassword: pass\n\t}\n\tlet url = api_link + \"/users/password-reset\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t}\n\t})\n\treturn response;\n}\n\nexport async function get_merchants() {\n\tlet url = api_link + \"/merchants\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t}\n\t})\n\treturn response.json();\n}\n\nexport async function get_merchant(id) {\n\tlet url = api_link + \"/merchants/\" + id;\n\tconst response = await fetch(url, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t}\n\t})\n\treturn response.json();\n}\n\nexport async function authorize_merchant(id) {\n\tlet url = api_link + \"/users/me/merchants/\" + id + \"/authorize\";\n\t\n\tconsole.log(url)\n\tconst response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response;\n}\n\nexport async function revoke_merchant(id) {\n\tlet url = api_link + \"/users/me/merchants/\" + id + \"/revoke\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response;\n}\n\nexport async function delete_account() {\n\tlet url = api_link + \"/users/me\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response;\n}\n\nexport const get_user = () => JSON.parse(localStorage.getItem('user'));\nexport const get_user_merchants = () => get_user().merchants;\nexport const get_measure = (index = 0) => get_nb_measures() ? get_user().measures[index] : [];\nexport const get_measures = () => get_user().measures;\nexport const get_nb_measures = () => get_user().measures.length;\nexport const get_token = () => localStorage.getItem('token');\n\nexport const change_firstname = (firstname) => change(firstname, \"firstname\", \"/users/me/firstname\");\nexport const change_lastname = (lastname) => change(lastname, \"lastname\", \"/users/me/lastname\");\nexport const change_measure_name = async (id, name) => await change(name, \"name\", \"/users/me/measures/\" + id + \"/name\");\nexport const change_measure_height = async (id, height) => await change(height, \"height\", \"/users/me/measures/\" + id + \"/height\");\nexport const change_measure_weight = async (id, weight) => await change(weight, \"weight\", \"/users/me/measures/\" + id + \"/weight\");\nexport const logout = () => {\n\tlocalStorage.clear();\n\t//popupDisplay('center', 1500, 'success', 'Déconnexion réussie');\n\t//setTimeout(function() {history.push(\"/\")},1500);\n}\n\n"]},"metadata":{},"sourceType":"module"}