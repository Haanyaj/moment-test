{"ast":null,"code":"import { api_link, api_key } from '../../globals';\nexport async function request_token(language, page) {\n  const url = api_link + '/movie/popular';\n  const new_url = url.concat('?api_key=', api_key, '&language=', language, '&page=', page);\n  let response = await fetch(new_url, {\n    method: 'GET',\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  response = await response.json();\n  console.log(response);\n  return response;\n}\nexport async function signup(state) {\n  const url = api_link + '/auth/signup';\n  let data = {\n    firstname: state.firstname,\n    lastname: state.lastname,\n    email: state.email,\n    password: state.password\n  };\n  const response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  return response.status;\n}\nexport async function update_user() {\n  let token = localStorage.getItem('token');\n  const response = await fetch(api_link + \"/users/me\", {\n    method: 'GET',\n    headers: {\n      'accept': 'application/json',\n      'Authorization': 'Bearer ' + token\n    }\n  });\n  const responseToJson = await response.json();\n  let user = responseToJson;\n\n  if (user) {\n    localStorage.setItem('user', JSON.stringify(user));\n  } else {\n    console.log(\"an error occured\");\n  }\n\n  console.log(\"user changed\");\n  return response;\n}\n\nasync function change(to_change, field, uri) {\n  let url = api_link + uri;\n  let data = '{\"' + field + '\":\"' + to_change + '\"}';\n  const response = await fetch(url, {\n    method: 'PATCH',\n    body: data,\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  console.log(data);\n  await update_user();\n  return response;\n}\n\nexport async function change_password(old_password, new_password) {\n  let url = api_link + \"/users/me/password\";\n  let data = {\n    newPassword: new_password,\n    oldPassword: old_password\n  };\n  let response = await fetch(url, {\n    method: 'PATCH',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function change_username(firstname, lastname) {\n  let url = api_link + \"/users/me\";\n  let data = {\n    firstname: firstname,\n    lastname: lastname\n  };\n  let response = await fetch(url, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function change_measures(id, name, height, weight) {\n  let url = api_link + \"/users/me/measures/\" + id;\n  let data = {\n    name: name,\n    height: height,\n    weight: weight\n  };\n  let response = await fetch(url, {\n    method: 'PUT',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function create_measures(name, height, weight) {\n  let url = api_link + \"/users/me/measures\";\n  let data = {\n    name: name,\n    height: height,\n    weight: weight\n  };\n  let response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function delete_measures(id) {\n  let url = api_link + \"/users/me/measures/\" + id;\n  const response = await fetch(url, {\n    method: 'DELETE',\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function request_password_reset(email) {\n  let data = {\n    email: email\n  };\n  let url = api_link + \"/users/request-password-reset\";\n  const response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  return response;\n}\nexport async function confirm_account(token) {\n  let data = {\n    token: token\n  };\n  let url = api_link + \"/users/confirm-account\";\n  const response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function reset_password(token, pass) {\n  let data = {\n    token: token,\n    password: pass\n  };\n  let url = api_link + \"/users/password-reset\";\n  const response = await fetch(url, {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  return response;\n}\nexport async function get_merchants() {\n  let url = api_link + \"/merchants\";\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  return response.json();\n}\nexport async function get_merchant(id) {\n  let url = api_link + \"/merchants/\" + id;\n  const response = await fetch(url, {\n    method: 'GET',\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json'\n    }\n  });\n  return response.json();\n}\nexport async function authorize_merchant(id) {\n  let url = api_link + \"/users/me/merchants/\" + id + \"/authorize\";\n  console.log(url);\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Accept': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function revoke_merchant(id) {\n  let url = api_link + \"/users/me/merchants/\" + id + \"/revoke\";\n  const response = await fetch(url, {\n    method: 'POST',\n    headers: {\n      'Accept': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport async function delete_account() {\n  let url = api_link + \"/users/me\";\n  const response = await fetch(url, {\n    method: 'DELETE',\n    headers: {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + get_token()\n    }\n  });\n  await update_user();\n  return response;\n}\nexport const get_user = () => JSON.parse(localStorage.getItem('user'));\nexport const get_user_merchants = () => get_user().merchants;\nexport const get_measure = (index = 0) => get_nb_measures() ? get_user().measures[index] : [];\nexport const get_measures = () => get_user().measures;\nexport const get_nb_measures = () => get_user().measures.length;\nexport const get_token = () => localStorage.getItem('token');\nexport const change_firstname = firstname => change(firstname, \"firstname\", \"/users/me/firstname\");\nexport const change_lastname = lastname => change(lastname, \"lastname\", \"/users/me/lastname\");\nexport const change_measure_name = async (id, name) => await change(name, \"name\", \"/users/me/measures/\" + id + \"/name\");\nexport const change_measure_height = async (id, height) => await change(height, \"height\", \"/users/me/measures/\" + id + \"/height\");\nexport const change_measure_weight = async (id, weight) => await change(weight, \"weight\", \"/users/me/measures/\" + id + \"/weight\");\nexport const logout = () => {\n  localStorage.clear(); //popupDisplay('center', 1500, 'success', 'Déconnexion réussie');\n  //setTimeout(function() {history.push(\"/\")},1500);\n};","map":{"version":3,"sources":["/home/haan/moment-test/src/components/tools/ApiCalls.js"],"names":["api_link","api_key","request_token","language","page","url","new_url","concat","response","fetch","method","headers","json","console","log","signup","state","data","firstname","lastname","email","password","body","JSON","stringify","status","update_user","token","localStorage","getItem","responseToJson","user","setItem","change","to_change","field","uri","get_token","change_password","old_password","new_password","newPassword","oldPassword","change_username","change_measures","id","name","height","weight","create_measures","delete_measures","request_password_reset","confirm_account","reset_password","pass","get_merchants","get_merchant","authorize_merchant","revoke_merchant","delete_account","get_user","parse","get_user_merchants","merchants","get_measure","index","get_nb_measures","measures","get_measures","length","change_firstname","change_lastname","change_measure_name","change_measure_height","change_measure_weight","logout","clear"],"mappings":"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","sourcesContent":["import { api_link, api_key } from '../../globals';\n\n\nexport async function request_token(language, page) {\n\tconst url = api_link + '/movie/popular';\n\tconst new_url = url.concat('?api_key=', api_key, '&language=', language, '&page=', page);\n    let response = await fetch(new_url, {\n\t\tmethod: 'GET',\n        headers: {\n\t\t\t'Accept': 'application/json',\n            'Content-type': 'application/json'\n\t\t}\n\t\t\n\t})\n\tresponse = await response.json()\n\t console.log( response)\n\treturn  response\n}\n\nexport async function signup(state) {\n\n\tconst url= api_link + '/auth/signup';\n\tlet data = {\n\t\tfirstname: state.firstname,\n\t\tlastname: state.lastname,\n\t\temail: state.email,\n\t\tpassword: state.password,\n\t}\n        const response = await fetch(url, {\n\t\tmethod:'POST',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json'\n\t\t}\n\t})\n\treturn response.status;\n}\n\nexport async function update_user() {\n\tlet token = localStorage.getItem('token');\n\n\n\tconst response = await fetch(api_link + \"/users/me\", {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'accept': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + token\n\t\t}\n\t});\n\n\tconst responseToJson = await response.json();\n\tlet user = responseToJson;\n\tif (user) {\n\t\tlocalStorage.setItem('user', JSON.stringify(user));\n\t} else {\n\t\tconsole.log(\"an error occured\");\n\t}\n\tconsole.log(\"user changed\")\n\treturn response;\n}\n\n\nasync function change(to_change, field, uri) {\n\tlet url = api_link + uri;\n\tlet data = '{\"' + field + '\":\"' + to_change + '\"}'\n\tconst response = await fetch(url, {\n\t\tmethod: 'PATCH',\n\t\tbody: data,\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tconsole.log(data);\n\tawait update_user();\n\treturn response;\n}\n\nexport async function change_password(old_password, new_password) {\n\tlet url = api_link + \"/users/me/password\";\n\tlet data = {\n\t\tnewPassword: new_password,\n\t\toldPassword: old_password\n\t}\n\tlet response = await fetch(url, {\n\t\tmethod: 'PATCH',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response\n}\n\nexport async function change_username(firstname, lastname) {\n\tlet url = api_link + \"/users/me\";\n\tlet data = {\n\t\tfirstname: firstname,\n\t\tlastname: lastname\n\t}\n\tlet response = await fetch(url, {\n\t\tmethod: 'PUT',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\t\n\tawait update_user();\n\treturn response\n}\n\nexport async function change_measures(id, name, height, weight) {\n\tlet url = api_link + \"/users/me/measures/\" + id;\n\tlet data = {\n\t\tname: name,\n\t\theight: height,\n\t\tweight: weight,\n\t}\n\tlet response = await fetch(url, {\n\t\tmethod: 'PUT',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response\n}\n\n\n\nexport async function create_measures(name, height, weight) {\n\tlet url = api_link + \"/users/me/measures\";\n\tlet data = {\n\t\tname: name,\n\t\theight: height,\n\t\tweight: weight\n\t}\n\tlet response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response\n}\n\nexport async function delete_measures(id) {\n\tlet url = api_link + \"/users/me/measures/\" + id;\n\tconst response = await fetch(url, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response;\n}\n\nexport async function request_password_reset(email) {\n\tlet data = {\n\t\temail: email\n\t}\n\tlet url =  api_link + \"/users/request-password-reset\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t}\n\t})\n\treturn response;\n}\n\nexport async function confirm_account(token) {\n\tlet data = {\n\t\ttoken: token\n\t}\n\tlet url = api_link + \"/users/confirm-account\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t}\n\t})\n\tawait update_user();\n\treturn response;\n}\n\nexport async function reset_password(token, pass) {\n\tlet data = {\n\t\ttoken: token,\n\t\tpassword: pass\n\t}\n\tlet url = api_link + \"/users/password-reset\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\tbody: JSON.stringify(data),\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t}\n\t})\n\treturn response;\n}\n\nexport async function get_merchants() {\n\tlet url = api_link + \"/merchants\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t}\n\t})\n\treturn response.json();\n}\n\nexport async function get_merchant(id) {\n\tlet url = api_link + \"/merchants/\" + id;\n\tconst response = await fetch(url, {\n\t\tmethod: 'GET',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t}\n\t})\n\treturn response.json();\n}\n\nexport async function authorize_merchant(id) {\n\tlet url = api_link + \"/users/me/merchants/\" + id + \"/authorize\";\n\t\n\tconsole.log(url)\n\tconst response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response;\n}\n\nexport async function revoke_merchant(id) {\n\tlet url = api_link + \"/users/me/merchants/\" + id + \"/revoke\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response;\n}\n\nexport async function delete_account() {\n\tlet url = api_link + \"/users/me\";\n\tconst response = await fetch(url, {\n\t\tmethod: 'DELETE',\n\t\theaders: {\n\t\t\t'Accept': 'application/json',\n\t\t\t'Content-type': 'application/json',\n\t\t\t'Authorization': 'Bearer ' + get_token()\n\t\t}\n\t})\n\tawait update_user();\n\treturn response;\n}\n\nexport const get_user = () => JSON.parse(localStorage.getItem('user'));\nexport const get_user_merchants = () => get_user().merchants;\nexport const get_measure = (index = 0) => get_nb_measures() ? get_user().measures[index] : [];\nexport const get_measures = () => get_user().measures;\nexport const get_nb_measures = () => get_user().measures.length;\nexport const get_token = () => localStorage.getItem('token');\n\nexport const change_firstname = (firstname) => change(firstname, \"firstname\", \"/users/me/firstname\");\nexport const change_lastname = (lastname) => change(lastname, \"lastname\", \"/users/me/lastname\");\nexport const change_measure_name = async (id, name) => await change(name, \"name\", \"/users/me/measures/\" + id + \"/name\");\nexport const change_measure_height = async (id, height) => await change(height, \"height\", \"/users/me/measures/\" + id + \"/height\");\nexport const change_measure_weight = async (id, weight) => await change(weight, \"weight\", \"/users/me/measures/\" + id + \"/weight\");\nexport const logout = () => {\n\tlocalStorage.clear();\n\t//popupDisplay('center', 1500, 'success', 'Déconnexion réussie');\n\t//setTimeout(function() {history.push(\"/\")},1500);\n}\n\n"]},"metadata":{},"sourceType":"module"}